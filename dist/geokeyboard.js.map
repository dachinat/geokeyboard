{"version":3,"sources":["webpack:///webpack/bootstrap d85ac7afd6557d38aa83","webpack:///./src/main.js","webpack:///./src/insert-at-caret.js"],"names":["insertAtCaret","require","Geokeyboard","selectors","params","opts","lastFocus","Object","assign","hotSwitchKey","globalHotSwitch","globalCheckbox","useLocalStorage","listen","_loadLocalStorage","callback","constructor","_warnBadSelector","Array","from","document","querySelectorAll","forEach","selector","getContext","replaceOnType","hotSwitch","onChange","checkbox","checkFocus","listeners","toggleListener","_replaceTyped","call","e","_replacePasted","_hotSwitch","_checkFocus","querySelector","watchCheckbox","_watchCheckbox","Set","concat","listener","type","fn","useCapture","index","hasListener","addListener","removeListener","push","addEventListener","getListener","removeEventListener","splice","findIndex","f","l","find","undefined","enableCheckbox","checked","console","log","_addToLocalStorage","disableCheckbox","state","JSON","parse","localStorage","getItem","localStorageKey","_enable","s","_disable","RegExp","characterSet","join","test","key","length","preventDefault","currentTarget","String","fromCharCode","indexOf","content","clipboardData","getData","window","split","map","c","filter","includes","frameElement","focus","keyCode","which","_toggle","setItem","warn","name","tagName","toLowerCase","contentWindow","contentDocument","element","sel","range","windowContext","documentContext","getSelection","getRangeAt","rangeCount","deleteContents","el","createElement","innerHTML","frag","createDocumentFragment","node","lastNode","firstChild","appendChild","insertNode","cloneRange","setStartAfter","collapse","removeAllRanges","addRange","selection","createRange","pasteHTML","selectionStart","selectionEnd","start","value","slice","normal","replace","textInputRange","createTextRange","moveToBookmark","getBookmark","endRange","end","compareEndPoints","charLength","moveStart","moveEnd","module","exports"],"mappings":"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","file":"geokeyboard.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d85ac7afd6557d38aa83","const insertAtCaret = require(\"./insert-at-caret\");\n\nclass Geokeyboard {\n    constructor(selectors, params={}, opts={}) {\n        this.selectors = [];\n        this.lastFocus = null;\n\n        this.params = Object.assign({\n            hotSwitchKey: 96,\n            globalHotSwitch: null,\n            globalCheckbox: null,\n            useLocalStorage: true\n        }, params);\n\n        this.listen(selectors, opts);\n\n        if (this.params.useLocalStorage) {\n            this._loadLocalStorage();\n        }\n    }\n\n    listen(selectors, opts={}, callback=null) {\n        this.constructor._warnBadSelector(selectors);\n\n        selectors = Array.from(document.querySelectorAll(selectors));\n\n        selectors.forEach(selector => {\n            selector = this.constructor.getContext(selector);\n\n            if (!selector.opts) {\n                selector.opts = {\n                    replaceOnType: true,\n                    hotSwitch: true,\n                    onChange: null,\n                    checkbox: null,\n                    checkFocus: true,\n                    listeners: [],\n                };\n            }\n            selector.opts = Object.assign(selector.opts, opts);\n\n            this.toggleListener(selector, 'replaceOnType', 'keypress', e => {\n               this.constructor._replaceTyped.call(this, e);\n            });\n\n            this.toggleListener(selector, 'replaceOnPaste', 'paste', e => {\n                this.constructor._replacePasted.call(this, e);\n            });\n\n            this.toggleListener(selector, 'hotSwitch', 'keypress', e => {\n                this.constructor._hotSwitch.call(this, e);\n            });\n\n            this.toggleListener(selector, 'checkFocus', 'focus', e => {\n               this.constructor._checkFocus.call(this, e);\n            }, true);\n\n            if (this.params.globalCheckbox) {\n                const globalCheckbox = document.querySelector(this.params.globalCheckbox);\n\n                if (!globalCheckbox.opts) {\n                    globalCheckbox.opts = { watchCheckbox: true, listeners: [], };\n                }\n\n                this.toggleListener(globalCheckbox, 'watchCheckbox', 'change', e => {\n                    this.constructor._watchCheckbox.call(this, e);\n                });\n            }\n\n            if (selector.opts.checkbox) {\n                const checkbox = document.querySelector(selector.opts.checkbox);\n\n                if (!checkbox.opts) {\n                    checkbox.opts = { watchCheckbox: true, listeners: [], };\n                }\n\n                this.toggleListener(checkbox, 'watchCheckbox', 'change', e => {\n                    this.constructor._watchCheckbox.call(this, e);\n                });\n            }\n        });\n\n        this.selectors = Array.from(new Set(this.selectors.concat(selectors)));\n\n        if (this.params.useLocalStorage) {\n            this._loadLocalStorage();\n        }\n\n        if (callback) {\n            callback.call(this, selectors);\n        }\n\n        return this;\n    }\n\n\n    toggleListener(selector, listener, type, fn, useCapture=false) {\n        const index = this.hasListener(selector, listener);\n\n        if (selector.opts[listener]) {\n            if (index === false) {\n                this.addListener(selector, listener, type, fn, useCapture)\n            }\n        } else {\n            if (index !== false) {\n                this.removeListener(selector, listener, type, useCapture);\n            }\n        }\n    }\n\n    addListener(selector, listener, type, fn) {\n        selector.opts.listeners.push({[listener]: fn});\n        selector.addEventListener(type, this.getListener(selector, listener));\n    }\n\n    removeListener(selector, listener, type) {\n        selector.removeEventListener(type, this.getListener(selector, listener));\n        selector.opts.listeners.splice(this.hasListener(selector, listener), 1);\n    }\n\n    hasListener(selector, listener) {\n        const index = selector.opts.listeners.findIndex(f => typeof f[listener] === 'function');\n        return index === -1 ? false : index;\n    }\n\n\n    getListener(selector, listener) {\n        const l = selector.opts.listeners.find(f => f[listener]);\n        if (!l) {\n            //console.warn(`No such listener as '${listener}' for '${selector.outerHTML}'`);\n        }\n        return l ? l[listener] : undefined;\n    }\n\n    _enable(selector, enableCheckbox=true) {\n        selector = this.constructor.getContext(selector);\n        selector.opts.replaceOnType = true;\n\n        this.addListener(selector, 'replaceOnType', 'keypress', e => {\n            this.constructor._replaceTyped.call(this, e);\n        });\n\n        if (selector.opts['onChange']) {\n            selector.opts['onChange'].call(this, true);\n        }\n\n        if (selector.opts.checkbox && enableCheckbox) {\n            document.querySelector(selector.opts.checkbox).checked = true;\n        }\n\n        if (this.params.globalCheckbox) {\n            document.querySelector(this.params.globalCheckbox).checked = true;\n        }\n\n        if (this.params.useLocalStorage) {\n            console.log('add');\n            this.constructor._addToLocalStorage.call(this, true);\n        }\n    }\n\n    _disable(selector, disableCheckbox=true) {\n        selector = this.constructor.getContext(selector);\n        selector.opts.replaceOnType = false;\n\n        const listener = this.getListener(selector, 'replaceOnType');\n        if (!listener) {\n            return;\n        }\n\n        this.removeListener(selector, 'replaceOnType', 'keypress', listener);\n\n        if (selector.opts['onChange']) {\n            selector.opts['onChange'].call(this, false);\n        }\n\n        if (selector.opts.checkbox && disableCheckbox) {\n            document.querySelector(selector.opts.checkbox).checked = false;\n        }\n\n        if (this.params.globalCheckbox) {//?\n            document.querySelector(this.params.globalCheckbox).checked = false;\n        }\n\n        if (this.params.useLocalStorage) {\n            this.constructor._addToLocalStorage.call(this, false);\n        }\n    }\n\n    _loadLocalStorage() {\n        const state = JSON.parse(localStorage.getItem(this.constructor.localStorageKey));\n\n        console.log(state);\n\n        if (state === null) {\n            return;\n        }\n\n        this.selectors.forEach(s => {\n            return state ? this._enable(s) : this._disable(s);\n        });\n    }\n\n    static _replaceTyped(e) {\n        if (!new RegExp(this.constructor.characterSet.join('|')).test(e.key) || e.key.length > 1) {\n            //|| !this.o.active) {\n            //|| !e.currentTarget.opts.active) {\n            return;\n        }\n        e.preventDefault();\n\n        insertAtCaret(e.currentTarget, String.fromCharCode(this.constructor.characterSet.indexOf(e.key) + 4304));\n    }\n\n    static _replacePasted(e) {\n        let content = e.clipboardData ? e.clipboardData.getData('text/plain') : window.clipboardData ?\n            window.clipboardData.getData('Text') : null;\n\n        insertAtCaret(e.currentTarget, content.split('')\n            .map(c => {\n                let index = this.constructor.characterSet.indexOf(c);\n                return index !== -1 ? String.fromCharCode(index + 4304) : c;\n            })\n            .join(''));\n\n        e.preventDefault();\n    }\n\n    static _checkFocus(e) {\n        if (e.currentTarget.opts.checkbox) {\n            document.querySelector(e.currentTarget.opts.checkbox).checked = e.currentTarget.opts.replaceOnType;\n        }\n\n        if (this.params.globalCheckbox) {\n            document.querySelector(this.params.globalCheckbox).checked = e.currentTarget.opts.replaceOnType;\n        }\n\n        this.lastFocus = e.currentTarget;\n    }\n\n    static _watchCheckbox(e) {\n        let selectors = document.querySelector(this.params.globalCheckbox) === e.currentTarget ? this.selectors :\n            this.selectors.filter(selector => {\n                selector = this.constructor.getContext(selector);\n                return (document.querySelector(selector.opts.checkbox) === e.currentTarget);\n            });\n\n        selectors.forEach(s => {\n            e.currentTarget.checked ? this._enable(s) : this._disable(s);\n        });\n\n\n        if (this.lastFocus && selectors.includes(this.lastFocus.frameElement || this.lastFocus)) {\n            this.lastFocus.focus();\n        } else {\n           this.constructor.getContext(selectors[0]).focus();\n        }\n    }\n\n    static _hotSwitch(e) {\n        if (e.keyCode === this.params.hotSwitchKey || e.which === this.params.hotSwitchKey) {\n            this.constructor._toggle.call(this, e.currentTarget);\n            e.preventDefault();\n        }\n    }\n\n    static _toggle(selector) {\n        const index = this.hasListener(selector, 'replaceOnType');\n\n        if (index !== false) {\n            if (typeof this.params.globalHotSwitch === 'function') {\n               this.selectors.forEach(s => this._disable(s, s === selector));\n               this.params.globalHotSwitch.call(this, false);\n            } else {\n                this._disable(selector);\n            }\n        } else {\n            if (typeof this.params.globalHotSwitch === 'function') {\n               this.selectors.forEach(s => this._enable(s, s === selector));\n                this.params.globalHotSwitch.call(this, true);\n            } else {\n                this._enable(selector);\n            }\n        }\n    }\n\n    static _addToLocalStorage(state) {\n        console.log('##'+state);\n        localStorage.setItem(this.constructor.localStorageKey, state);\n    }\n\n    static _warnBadSelector(selectors) {\n        selectors.split(', ').forEach(selector => {\n            if (!document.querySelector(selector)) {\n                console\n                    .warn(`${this.constructor.name}: An element with identifier '${selector}' not found. (Skipping...)`);\n                return true;\n            }\n        });\n    }\n\n    static get characterSet() {\n        return 'abgdevzTiklmnopJrstufqRySCcZwWxjh'.split('');\n    }\n\n    static getContext(selector) {\n        return (selector.tagName.toLowerCase() === 'iframe') ?\n            (selector.contentWindow || selector.contentDocument).window : selector;\n    }\n\n    static get localStorageKey() {\n        return 'geokeyboard';\n    }\n\n    // Not implemented\n    static get propertyName() {\n        return this.constructor.name;\n    }\n}\n\nwindow.Geokeyboard = Geokeyboard;\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","const insertAtCaret = (element, content) => {\n\n    const tagName = (element.tagName || element.frameElement.tagName).toLowerCase();\n\n    if (tagName === 'div' || tagName === 'iframe') {\n        let sel, range;\n\n        let windowContext = window, documentContext = document;\n        if (tagName === 'iframe') {\n            windowContext = element.window;\n            documentContext = element.document;\n        }\n\n        if (windowContext.getSelection) {\n            sel = windowContext.getSelection();\n            if (sel.getRangeAt && sel.rangeCount) {\n                range = sel.getRangeAt(0);\n                range.deleteContents();\n\n                let el = documentContext.createElement('div');\n                el.innerHTML = content;\n                let frag = documentContext.createDocumentFragment(), node, lastNode;\n                while ((node = el.firstChild)) {\n                    lastNode = frag.appendChild(node);\n                }\n                range.insertNode(frag);\n\n                if (lastNode) {\n                    range = range.cloneRange();\n                    range.setStartAfter(lastNode);\n                    range.collapse(true);\n                    sel.removeAllRanges();\n                    sel.addRange(range);\n                }\n            }\n        } else if (documentContext.selection && documentContext.selection.type !== 'Control') {\n            documentContext.selection.createRange().pasteHTML(content);\n        }\n    } else if (tagName === 'input' || tagName === 'textarea') {\n        if (typeof element.selectionStart === 'number' && typeof element.selectionEnd === 'number') {\n            const start = element.selectionStart;\n            element.value = element.value.slice(0, start) + content + element.value.slice(element.selectionEnd);\n            element.selectionStart = element.selectionEnd = start + 1;\n        } else {\n            const range = document.selection.createRange();\n            let normal = element.value.replace(/\\r\\n/g, '\\n');\n\n            let textInputRange = element.createTextRange();\n            textInputRange.moveToBookmark(range.getBookmark());\n\n            let endRange = element.createTextRange();\n            endRange.collapse(false);\n\n            let start, end;\n            if (textInputRange.compareEndPoints('StartToEnd', endRange) > -1) {\n                start = end = charLength;\n            } else {\n                start = -textInputRange.moveStart('character', -charLength);\n                start += normal.slice(0, start).split('\\n').length - 1;\n\n                if (textInputRange.compareEndPoints('EndToEnd', endRange) > -1) {\n                    end = charLength;\n                } else {\n                    end = -textInputRange.moveEnd('character', -charLength);\n                    end += normal.slice(0, end).split('\\n').length - 1;\n                }\n            }\n\n            element.value = element.value.slice(0, start) + content + element.value.slice(end);\n            //start++;\n\n            textInputRange = element.createTextRange();\n            textInputRange.collapse(true);\n        }\n    }\n};\n\nmodule.exports = insertAtCaret;\n\n\n// WEBPACK FOOTER //\n// ./src/insert-at-caret.js"],"sourceRoot":""}