{"version":3,"sources":["webpack:///webpack/bootstrap 06d31818c09c6875d5cc","webpack:///./src/index.js","webpack:///./src/insert-at-caret.js"],"names":["insertAtCaret","require","Geokeyboard","selectors","params","opts","lastFocus","Object","assign","hotSwitchKey","globalHotSwitch","globalCheckbox","listen","callback","constructor","_warnBadSelector","Array","from","document","querySelectorAll","forEach","selector","getContext","replaceOnType","hotSwitch","onChange","checkbox","checkFocus","listeners","toggleListener","_replaceTyped","call","e","_replacePasted","_hotSwitch","_checkFocus","querySelector","watchCheckbox","_watchCheckbox","Set","concat","listener","type","fn","useCapture","index","hasListener","addListener","removeListener","push","addEventListener","getListener","removeEventListener","splice","findIndex","f","find","console","warn","outerHTML","enableCheckbox","checked","disableCheckbox","RegExp","characterSet","join","test","key","length","log","preventDefault","currentTarget","String","fromCharCode","indexOf","content","clipboardData","getData","window","split","map","c","filter","_enable","s","_disable","includes","frameElement","focus","keyCode","which","_toggle","name","tagName","toLowerCase","contentWindow","contentDocument","element","sel","range","windowContext","documentContext","getSelection","getRangeAt","rangeCount","deleteContents","el","createElement","innerHTML","frag","createDocumentFragment","node","lastNode","firstChild","appendChild","insertNode","cloneRange","setStartAfter","collapse","removeAllRanges","addRange","selection","createRange","pasteHTML","selectionStart","selectionEnd","start","value","slice","normal","replace","textInputRange","createTextRange","moveToBookmark","getBookmark","endRange","end","compareEndPoints","charLength","moveStart","moveEnd","module","exports"],"mappings":"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","file":"geokeyboard.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 06d31818c09c6875d5cc","const insertAtCaret = require(\"./insert-at-caret\");\n\nclass Geokeyboard {\n    constructor(selectors, params={}, opts={}) {\n        this.selectors = [];\n        this.lastFocus = null;\n\n        this.params = Object.assign({\n            hotSwitchKey: 96,\n            globalHotSwitch: null,\n            globalCheckbox: null,\n        }, params);\n\n        this.listen(selectors, opts);\n    }\n\n    listen(selectors, opts={}, callback=null) {\n        this.constructor._warnBadSelector(selectors);\n\n        selectors = Array.from(document.querySelectorAll(selectors));\n\n        selectors.forEach(selector => {\n            selector = this.constructor.getContext(selector);\n\n            if (!selector.opts) {\n                selector.opts = {\n                    replaceOnType: true,\n                    hotSwitch: true,\n                    onChange: null,\n                    checkbox: null,\n                    checkFocus: true,\n                    listeners: [],\n                };\n            }\n            selector.opts = Object.assign(selector.opts, opts);\n\n            this.toggleListener(selector, 'replaceOnType', 'keypress', e => {\n               this.constructor._replaceTyped.call(this, e);\n            });\n\n            this.toggleListener(selector, 'replaceOnPaste', 'paste', e => {\n                this.constructor._replacePasted.call(this, e);\n            });\n\n            this.toggleListener(selector, 'hotSwitch', 'keypress', e => {\n                this.constructor._hotSwitch.call(this, e);\n            });\n\n            this.toggleListener(selector, 'checkFocus', 'focus', e => {\n               this.constructor._checkFocus.call(this, e);\n            }, true);\n\n            if (this.params.globalCheckbox) {\n                const globalCheckbox = document.querySelector(this.params.globalCheckbox);\n\n                if (!globalCheckbox.opts) {\n                    globalCheckbox.opts = { watchCheckbox: true, listeners: [], };\n                }\n\n                this.toggleListener(globalCheckbox, 'watchCheckbox', 'change', e => {\n                    this.constructor._watchCheckbox.call(this, e);\n                });\n            }\n\n            if (selector.opts.checkbox) {\n                const checkbox = document.querySelector(selector.opts.checkbox);\n\n                if (!checkbox.opts) {\n                    checkbox.opts = { watchCheckbox: true, listeners: [], };\n                }\n\n                this.toggleListener(checkbox, 'watchCheckbox', 'change', e => {\n                    this.constructor._watchCheckbox.call(this, e);\n                });\n            }\n        });\n\n        this.selectors = Array.from(new Set(this.selectors.concat(selectors)));\n\n        if (callback) {\n            callback.call(this, selectors);\n        }\n\n        return this;\n    }\n\n\n    toggleListener(selector, listener, type, fn, useCapture=false) {\n        const index = this.hasListener(selector, listener);\n\n        if (selector.opts[listener]) {\n            if (index === false) {\n                this.addListener(selector, listener, type, fn, useCapture)\n            }\n        } else {\n            if (index !== false) {\n                this.removeListener(selector, listener, type, useCapture);\n            }\n        }\n    }\n\n    addListener(selector, listener, type, fn) {\n        selector.opts.listeners.push({[listener]: fn});\n        selector.addEventListener(type, this.getListener(selector, listener));\n    }\n\n    removeListener(selector, listener, type) {\n        selector.removeEventListener(type, this.getListener(selector, listener));\n        selector.opts.listeners.splice(this.hasListener(selector, listener), 1);\n    }\n\n    hasListener(selector, listener) {\n        const index = selector.opts.listeners.findIndex(f => typeof f[listener] === 'function');\n        return index === -1 ? false : index;\n    }\n\n    getListener(selector, listener) {\n        try {\n            return selector.opts.listeners.find(f => f[listener])[listener];\n        } catch (e) {\n            console.warn(`There is no such listener as '${listener}' for '${selector.outerHTML}'...`);\n        }\n    }\n\n    _enable(selector, enableCheckbox=true) {\n        selector = this.constructor.getContext(selector);\n        selector.opts.replaceOnType = true;\n\n        this.addListener(selector, 'replaceOnType', 'keypress', e => {\n            this.constructor._replaceTyped.call(this, e);\n        });\n\n        if (selector.opts['onChange']) {\n            selector.opts['onChange'].call(this, true);\n        }\n\n        if (selector.opts.checkbox && enableCheckbox) {\n            document.querySelector(selector.opts.checkbox).checked = true;\n        }\n\n        if (this.params.globalCheckbox) {\n            document.querySelector(this.params.globalCheckbox).checked = true;\n        }\n    }\n\n    _disable(selector, disableCheckbox=true) {\n        selector = this.constructor.getContext(selector);\n        selector.opts.replaceOnType = false;\n\n        this.removeListener(selector, 'replaceOnType', 'keypress', this.getListener(selector, 'replaceOnType'));\n\n        if (selector.opts['onChange']) {\n            selector.opts['onChange'].call(this, false);\n        }\n\n        if (selector.opts.checkbox && disableCheckbox) {\n            document.querySelector(selector.opts.checkbox).checked = false;\n        }\n\n        if (this.params.globalCheckbox) {//?\n            document.querySelector(this.params.globalCheckbox).checked = false;\n        }\n    }\n\n    static _replaceTyped(e) {\n        if (!new RegExp(this.constructor.characterSet.join('|')).test(e.key) || e.key.length > 1) {\n            //|| !this.o.active) {\n            //|| !e.currentTarget.opts.active) {\n            return;\n        }\n        console.log('return');\n        e.preventDefault();\n\n        insertAtCaret(e.currentTarget, String.fromCharCode(this.constructor.characterSet.indexOf(e.key) + 4304));\n    }\n\n    static _replacePasted(e) {\n        let content = e.clipboardData ? e.clipboardData.getData('text/plain') : window.clipboardData ?\n            window.clipboardData.getData('Text') : null;\n\n        insertAtCaret(e.currentTarget, content.split('')\n            .map(c => {\n                let index = this.constructor.characterSet.indexOf(c);\n                return index !== -1 ? String.fromCharCode(index + 4304) : c;\n            })\n            .join(''));\n\n        e.preventDefault();\n    }\n\n    static _checkFocus(e) {\n        if (e.currentTarget.opts.checkbox) {\n            document.querySelector(e.currentTarget.opts.checkbox).checked = e.currentTarget.opts.replaceOnType;\n        }\n\n        if (this.params.globalCheckbox) {\n            document.querySelector(this.params.globalCheckbox).checked = e.currentTarget.opts.replaceOnType;\n        }\n\n        this.lastFocus = e.currentTarget;\n    }\n\n    static _watchCheckbox(e) {\n        let selectors = document.querySelector(this.params.globalCheckbox) === e.currentTarget ? this.selectors :\n            this.selectors.filter(selector => {\n                selector = this.constructor.getContext(selector);\n                return (document.querySelector(selector.opts.checkbox) === e.currentTarget);\n            });\n\n        selectors.forEach(s => {\n            e.currentTarget.checked ? this._enable(s) : this._disable(s);\n        });\n\n\n        if (this.lastFocus && selectors.includes(this.lastFocus.frameElement || this.lastFocus)) {\n            this.lastFocus.focus();\n        } else {\n           this.constructor.getContext(selectors[0]).focus();\n        }\n    }\n\n    static _hotSwitch(e) {\n        if (e.keyCode === this.params.hotSwitchKey || e.which === this.params.hotSwitchKey) {\n            this.constructor._toggle.call(this, e.currentTarget);\n            e.preventDefault();\n        }\n    }\n\n    static _toggle(selector) {\n        const index = this.hasListener(selector, 'replaceOnType');\n\n        if (index !== false) {\n            if (typeof this.params.globalHotSwitch === 'function') {\n               this.selectors.forEach(s => this._disable(s, s === selector));\n               this.params.globalHotSwitch.call(this, false);\n            } else {\n                this._disable(selector);\n            }\n        } else {\n            if (typeof this.params.globalHotSwitch === 'function') {\n               this.selectors.forEach(s => this._enable(s, s === selector));\n                this.params.globalHotSwitch.call(this, true);\n            } else {\n                this._enable(selector);\n            }\n        }\n    }\n\n    static _warnBadSelector(selectors) {\n        selectors.split(', ').forEach(selector => {\n            if (!document.querySelector(selector)) {\n                console\n                    .warn(`${this.constructor.name}: An element with identifier '${selector}' not found. (Skipping...)`);\n                return true;\n            }\n        });\n    }\n\n    static get characterSet() {\n        return 'abgdevzTiklmnopJrstufqRySCcZwWxjh'.split('');\n    }\n\n    static getContext(selector) {\n        return (selector.tagName.toLowerCase() === 'iframe') ?\n            (selector.contentWindow || selector.contentDocument).window : selector;\n    }\n\n    // Not implemented\n    static get propertyName() {\n        return this.constructor.name;\n    }\n}\n\nwindow.Geokeyboard = Geokeyboard;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const insertAtCaret = (element, content) => {\n\n    const tagName = (element.tagName || element.frameElement.tagName).toLowerCase();\n\n    if (tagName === 'div' || tagName === 'iframe') {\n        let sel, range;\n\n        let windowContext = window, documentContext = document;\n        if (tagName === 'iframe') {\n            windowContext = element.window;\n            documentContext = element.document;\n        }\n\n        if (windowContext.getSelection) {\n            sel = windowContext.getSelection();\n            if (sel.getRangeAt && sel.rangeCount) {\n                range = sel.getRangeAt(0);\n                range.deleteContents();\n\n                let el = documentContext.createElement('div');\n                el.innerHTML = content;\n                let frag = documentContext.createDocumentFragment(), node, lastNode;\n                while ((node = el.firstChild)) {\n                    lastNode = frag.appendChild(node);\n                }\n                range.insertNode(frag);\n\n                if (lastNode) {\n                    range = range.cloneRange();\n                    range.setStartAfter(lastNode);\n                    range.collapse(true);\n                    sel.removeAllRanges();\n                    sel.addRange(range);\n                }\n            }\n        } else if (documentContext.selection && documentContext.selection.type !== 'Control') {\n            documentContext.selection.createRange().pasteHTML(content);\n        }\n    } else if (tagName === 'input' || tagName === 'textarea') {\n        if (typeof element.selectionStart === 'number' && typeof element.selectionEnd === 'number') {\n            const start = element.selectionStart;\n            element.value = element.value.slice(0, start) + content + element.value.slice(element.selectionEnd);\n            element.selectionStart = element.selectionEnd = start + 1;\n        } else {\n            const range = document.selection.createRange();\n            let normal = element.value.replace(/\\r\\n/g, '\\n');\n\n            let textInputRange = element.createTextRange();\n            textInputRange.moveToBookmark(range.getBookmark());\n\n            let endRange = element.createTextRange();\n            endRange.collapse(false);\n\n            let start, end;\n            if (textInputRange.compareEndPoints('StartToEnd', endRange) > -1) {\n                start = end = charLength;\n            } else {\n                start = -textInputRange.moveStart('character', -charLength);\n                start += normal.slice(0, start).split('\\n').length - 1;\n\n                if (textInputRange.compareEndPoints('EndToEnd', endRange) > -1) {\n                    end = charLength;\n                } else {\n                    end = -textInputRange.moveEnd('character', -charLength);\n                    end += normal.slice(0, end).split('\\n').length - 1;\n                }\n            }\n\n            element.value = element.value.slice(0, start) + content + element.value.slice(end);\n            //start++;\n\n            textInputRange = element.createTextRange();\n            textInputRange.collapse(true);\n        }\n    }\n};\n\nmodule.exports = insertAtCaret;\n\n\n// WEBPACK FOOTER //\n// ./src/insert-at-caret.js"],"sourceRoot":""}